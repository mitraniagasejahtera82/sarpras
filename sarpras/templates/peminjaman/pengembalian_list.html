{% extends "sarpras/base.html" %}

{% block content %}
<div class="container my-4">

    <!-- Judul -->
    <div class="mb-3">
        <h4 class="fw-bold mb-0">Pengembalian Peralatan</h4>
        <small class="text-muted">
            Daftar peralatan yang masih dipinjam
        </small>
    </div>

    <!-- Card -->
    <div class="card shadow-sm">
        <div class="card-body p-0">

            <table class="table table-striped table-hover mb-0">
                <thead class="table-dark">
                    <tr>
                        <th>Peralatan</th>
                        <th>Peminjam</th>
                        <th>Jumlah</th>
                        <th>Tgl Pinjam</th>
                        <th class="text-center">Status</th>
                        <th class="text-center">Aksi</th>
                    </tr>
                </thead>
                <tbody>

                    {% for p in data %}
                    <tr>
                        <td>{{ p.barang }}</td>
                        <td>{{ p.peminjam }}</td>
                        <td>{{ p.jumlah_pinjam }}</td>
                        <td>{{ p.tanggal_pinjam|date:"d M Y" }}</td>

                        <!-- Status -->
                        <td class="text-center">
                            {% if p.status|lower == 'dipinjam' %}
                                <span class="badge bg-warning text-dark">
                                    Dipinjam
                                </span>
                            {% else %}
                                <span class="badge bg-success">
                                    Dikembalikan
                                </span>
                            {% endif %}
                        </td>

                        <!-- Aksi -->
                        <td class="text-center">
                            {% if p.status|lower == 'dipinjam' %}
                                <a href="{% url 'peminjaman_kembali' p.id %}"
                                   class="btn btn-sm btn-success">
                                    ✔ Konfirmasi
                                </a>
                            {% else %}
                                <button class="btn btn-sm btn-secondary" disabled>
                                    ✓ Selesai
                                </button>
                            {% endif %}
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="6" class="text-center text-muted py-4">
                            Tidak ada peralatan yang perlu dikembalikan
                        </td>
                    </tr>
                    {% endfor %}

                </tbody>
            </table>

        </div>
    </div>

</div>
{% endblock %}
